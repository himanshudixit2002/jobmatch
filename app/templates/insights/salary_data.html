{% extends "base.html" %}

{% block title %}India Tech Salary Trends | JobMatch{% endblock %}

{% block styles %}
<style>
    .salary-card {
        height: 100%;
        transition: all 0.3s ease;
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
    }
    
    .salary-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--box-shadow);
    }
    
    .salary-card .card-header {
        background: rgba(var(--bs-primary-rgb), 0.05);
        border-bottom: none;
        padding: 1rem 1.25rem;
    }
    
    .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
    }
    
    .stats-card {
        text-align: center;
        padding: 1.5rem;
        border-radius: var(--border-radius);
        background-color: #fff;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
    }
    
    .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--box-shadow);
    }
    
    .stat-icon-circle {
        width: 60px;
        height: 60px;
        margin: 0 auto 1rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(var(--bs-primary-rgb), 0.1);
        color: var(--bs-primary);
        font-size: 1.5rem;
    }
    
    .stats-card .stat-value {
        font-size: 2rem;
        font-weight: 700;
        display: block;
        margin-bottom: 0.5rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    
    .stats-card .stat-label {
        color: var(--bs-secondary);
        font-size: 1rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
    }
    
    .city-salary {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        padding: 0.5rem;
        border-radius: var(--border-radius);
        transition: all 0.2s ease;
    }
    
    .city-salary:hover {
        background-color: rgba(var(--bs-primary-rgb), 0.05);
    }
    
    .city-salary .city {
        width: 120px;
        font-weight: 500;
    }
    
    .city-salary .salary-bar {
        flex: 1;
        height: 24px;
        background: #f1f5f9;
        border-radius: 12px;
        position: relative;
        overflow: hidden;
    }
    
    .city-salary .salary-bar-fill {
        position: absolute;
        height: 100%;
        left: 0;
        top: 0;
        background: linear-gradient(90deg, rgba(var(--bs-primary-rgb), 0.8) 0%, rgba(var(--bs-primary-rgb), 1) 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding-right: 10px;
        color: white;
        font-weight: 500;
        font-size: 0.9rem;
        transition: width 0.8s ease-in-out;
    }
    
    .role-item {
        padding: 1.25rem;
        border-radius: var(--border-radius);
        background: #fff;
        margin-bottom: 1rem;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
        height: calc(100% - 1rem);
    }
    
    .role-item:hover {
        box-shadow: var(--box-shadow);
        transform: translateY(-3px);
    }
    
    .role-title {
        font-weight: 600;
        margin-bottom: 0.75rem;
    }
    
    .range-bar {
        height: 6px;
        background: #f1f5f9;
        border-radius: 3px;
        position: relative;
        margin: 0.75rem 0;
    }
    
    .range-fill {
        position: absolute;
        height: 100%;
        background: rgba(var(--bs-primary-rgb), 0.7);
        border-radius: 3px;
        transition: width 0.8s ease-in-out, left 0.8s ease-in-out;
    }
    
    .range-marker {
        position: absolute;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--bs-primary);
        top: -3px;
        margin-left: -6px;
        transition: left 0.8s ease-in-out;
    }
    
    .range-labels {
        display: flex;
        justify-content: space-between;
        font-size: 0.85rem;
        color: var(--bs-secondary);
    }
    
    .factor-item {
        transition: all 0.3s ease;
        border-radius: var(--border-radius);
        padding: 0.5rem;
    }
    
    .factor-item:hover {
        background-color: rgba(var(--bs-primary-rgb), 0.05);
    }
    
    .animated-number {
        transition: all 0.5s ease;
    }
    
    /* Insights navigation styles */
    .insights-header {
        margin-bottom: 2rem;
    }
    
    .insights-nav {
        margin-bottom: 2rem;
    }
    
    .insights-nav .nav-link {
        color: var(--dark);
        padding: 0.75rem 1.5rem;
        border-radius: var(--border-radius);
        font-weight: 500;
    }
    
    .insights-nav .nav-link.active {
        background: var(--gradient-primary);
        color: white !important;
    }
    
    @media (max-width: 767.98px) {
        .city-salary .city {
            width: 90px;
            font-size: 0.9rem;
        }
        
        .city-salary .salary-bar-fill {
            font-size: 0.8rem;
        }
        
        .stats-card .stat-value {
            font-size: 1.75rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<section class="py-5">
    <div class="container">
        <div class="insights-header">
            <h1 class="mb-3">Indian Tech Salary Trends</h1>
            <p class="text-muted">Comprehensive salary data for technology professionals across different roles, experience levels, and cities in India.</p>
        </div>
        
        <div class="insights-nav mb-4">
            <ul class="nav nav-pills">
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('insights.dashboard') }}">Overview</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('insights.trending_skills') }}">Trending Skills</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="{{ url_for('insights.salary_data') }}">Salary Data</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('insights.career_paths') }}">Career Paths</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('insights.job_growth') }}">Job Growth</a>
                </li>
            </ul>
        </div>
        
        <!-- Key Salary Statistics -->
            <div class="row mb-4">
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="card h-100">
                    <div class="card-body p-0">
                        <div class="stats-card h-100">
                            <div class="stat-icon-circle mb-3">
                                <i class="bi bi-cash-stack"></i>
                            </div>
                            <h3 class="stat-value animated-number" data-value="13.8">0</h3>
                            <p class="stat-label">Average Tech Salary</p>
                            <small class="text-success d-block">+10.4% YoY</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="card h-100">
                    <div class="card-body p-0">
                        <div class="stats-card h-100">
                            <div class="stat-icon-circle mb-3">
                                <i class="bi bi-graph-up-arrow"></i>
                            </div>
                            <h3 class="stat-value animated-number" data-value="15.7">0</h3>
                            <p class="stat-label">YoY Salary Growth for AI/ML</p>
                            <small class="text-success d-block">Highest growth sector</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card h-100">
                    <div class="card-body p-0">
                        <div class="stats-card h-100">
                            <div class="stat-icon-circle mb-3">
                                <i class="bi bi-building"></i>
                            </div>
                            <h3 class="stat-value animated-number" data-value="32">0</h3>
                            <p class="stat-label">Pay Gap: MNCs vs Indian Firms</p>
                            <small class="text-muted d-block">For similar roles & experience</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        <!-- Salary by Experience Chart -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card salary-card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Salary By Experience Level</h5>
                        <div class="chart-controls">
                            <button class="btn btn-sm btn-outline-primary toggle-chart-view" data-chart="experience-salary-chart" data-type="bar">Bar</button>
                            <button class="btn btn-sm btn-outline-secondary toggle-chart-view" data-chart="experience-salary-chart" data-type="line">Line</button>
                        </div>
                                </div>
                    <div class="card-body">
                        <div class="chart-container" style="position: relative; height:50vh; max-height: 400px;">
                            <canvas id="experience-salary-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cities Comparison -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card salary-card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Average Tech Salaries by City</h5>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="animateBars" checked>
                            <label class="form-check-label" for="animateBars">Animate</label>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="city-salary-container">
                            <div class="city-salary">
                                <span class="city">Bangalore</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="100%" data-value="16.2">₹16.2L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Hyderabad</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="94%" data-value="15.3">₹15.3L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Pune</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="90%" data-value="14.6">₹14.6L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Gurgaon</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="93%" data-value="15.1">₹15.1L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Mumbai</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="89%" data-value="14.5">₹14.5L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Chennai</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="84%" data-value="13.6">₹13.6L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Noida</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="83%" data-value="13.4">₹13.4L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Kolkata</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="72%" data-value="11.7">₹11.7L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Ahmedabad</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="71%" data-value="11.5">₹11.5L</div>
                                </div>
                            </div>
                            <div class="city-salary">
                                <span class="city">Indore</span>
                                <div class="salary-bar">
                                    <div class="salary-bar-fill" style="width: 0%;" data-width="67%" data-value="10.8">₹10.8L</div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            <button class="btn btn-sm btn-primary" id="resetAnimation">Reset Animation</button>
                            <button class="btn btn-sm btn-outline-primary ms-2" id="sortBySalary">Sort by Salary</button>
                            <button class="btn btn-sm btn-outline-primary ms-2" id="sortByCity">Sort by City</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Salary by Role Section -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card salary-card">
                    <div class="card-header">
                        <h5 class="mb-0">Salary Ranges by Role in India</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Full Stack Developer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">High Demand</span>
                                        <span class="text-end">Median: ₹13.5L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 0%; width: 0%;" data-left="20%" data-width="60%"></div>
                                        <div class="range-marker" style="left: 0%;" data-left="50%"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹7L</span>
                                        <span>₹28L+</span>
                        </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Data Scientist</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">High Demand</span>
                                        <span class="text-end">Median: ₹16.8L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 0%; width: 0%;" data-left="25%" data-width="60%"></div>
                                        <div class="range-marker" style="left: 0%;" data-left="55%"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹9L</span>
                                        <span>₹38L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">DevOps Engineer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">High Demand</span>
                                        <span class="text-end">Median: ₹15.2L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 22%; width: 58%;"></div>
                                        <div class="range-marker" style="left: 52%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹8L</span>
                                        <span>₹32L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">AI/ML Engineer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">Very High Demand</span>
                                        <span class="text-end">Median: ₹18.5L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 25%; width: 65%;"></div>
                                        <div class="range-marker" style="left: 58%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹10L</span>
                                        <span>₹45L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Cloud Architect</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">High Demand</span>
                                        <span class="text-end">Median: ₹20.5L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 35%; width: 50%;"></div>
                                        <div class="range-marker" style="left: 60%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹12L</span>
                                        <span>₹45L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Product Manager</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">High Demand</span>
                                        <span class="text-end">Median: ₹22.0L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 30%; width: 60%;"></div>
                                        <div class="range-marker" style="left: 62%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹14L</span>
                                        <span>₹48L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Cybersecurity Engineer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">Very High Demand</span>
                                        <span class="text-end">Median: ₹17.5L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 28%; width: 55%;"></div>
                                        <div class="range-marker" style="left: 55%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹10L</span>
                                        <span>₹36L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">UI/UX Designer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">Moderate Demand</span>
                                        <span class="text-end">Median: ₹12.5L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 20%; width: 50%;"></div>
                                        <div class="range-marker" style="left: 45%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹6L</span>
                                        <span>₹28L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Blockchain Developer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">Emerging Demand</span>
                                        <span class="text-end">Median: ₹16.2L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 25%; width: 60%;"></div>
                                        <div class="range-marker" style="left: 52%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹9L</span>
                                        <span>₹35L+</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6 mb-4">
                                <div class="role-item">
                                    <h6 class="role-title">Site Reliability Engineer</h6>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="badge bg-primary-subtle text-primary">High Demand</span>
                                        <span class="text-end">Median: ₹16.8L</span>
                                    </div>
                                    <div class="range-bar">
                                        <div class="range-fill" style="left: 26%; width: 58%;"></div>
                                        <div class="range-marker" style="left: 54%;"></div>
                                    </div>
                                    <div class="range-labels">
                                        <span>₹9L</span>
                                        <span>₹34L+</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Salary Trends and Factors -->
        <div class="row">
            <div class="col-lg-7 mb-4">
                <div class="card salary-card h-100">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Salary Growth Trends in Indian Tech</h5>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-outline-primary dropdown-toggle" type="button" id="trendFilterDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                Filter Roles
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="trendFilterDropdown">
                                <li><a class="dropdown-item" href="#" data-role="all">Show All Roles</a></li>
                                <li><a class="dropdown-item" href="#" data-role="AI/ML Specialists">AI/ML Specialists</a></li>
                                <li><a class="dropdown-item" href="#" data-role="Cloud/DevOps Engineers">Cloud/DevOps Engineers</a></li>
                                <li><a class="dropdown-item" href="#" data-role="Full Stack Developers">Full Stack Developers</a></li>
                                <li><a class="dropdown-item" href="#" data-role="Overall Tech Average">Overall Tech Average</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="salary-growth-chart"></canvas>
                        </div>
                        <div class="mt-3">
                            <p class="text-muted small">Data source: NASSCOM, Naukri JobSpeak Index, and JobMatch platform analytics for Q1 2024</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5 mb-4">
                <div class="card salary-card h-100">
                    <div class="card-header">
                        <h5 class="mb-0">Factors Affecting Tech Salaries in India</h5>
                    </div>
                    <div class="card-body">
                        <div class="factor-item d-flex mb-3">
                            <div class="bg-primary text-white rounded-circle p-2 me-3 d-flex align-items-center justify-content-center" style="width: 36px; height: 36px;">1</div>
                            <div>
                                <h6 class="mb-1">Company Type</h6>
                                <p class="text-muted mb-0">Product-based companies offer 30-45% higher salaries than service-based companies. MNCs offer 20-35% higher compensation than Indian companies for similar roles.</p>
                            </div>
                        </div>
                        <div class="factor-item d-flex mb-3">
                            <div class="bg-primary text-white rounded-circle p-2 me-3 d-flex align-items-center justify-content-center" style="width: 36px; height: 36px;">2</div>
                            <div>
                                <h6 class="mb-1">Skills Premium</h6>
                                <p class="text-muted mb-0">In-demand skills like generative AI, cybersecurity, and cloud native architecture command 30-45% higher salary compared to more common skills in the same experience bracket.</p>
                            </div>
                        </div>
                        <div class="factor-item d-flex mb-3">
                            <div class="bg-primary text-white rounded-circle p-2 me-3 d-flex align-items-center justify-content-center" style="width: 36px; height: 36px;">3</div>
                            <div>
                                <h6 class="mb-1">Location Factor</h6>
                                <p class="text-muted mb-0">Tier 1 cities (Bangalore, Hyderabad, Gurgaon) offer 25-35% higher salaries than Tier 2 cities. Remote work is narrowing this gap, with fully remote roles offering 15-20% premium.</p>
                            </div>
                        </div>
                        <div class="factor-item d-flex">
                            <div class="bg-primary text-white rounded-circle p-2 me-3 d-flex align-items-center justify-content-center" style="width: 36px; height: 36px;">4</div>
                            <div>
                                <h6 class="mb-1">Educational Background</h6>
                                <p class="text-muted mb-0">Graduates from premier institutes (IITs, NITs, IIITs) command 15-25% higher starting salaries. This gap narrows with experience, becoming less significant after 5+ years.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize charts
        const experienceChart = createExperienceSalaryChart();
        const growthChart = createSalaryGrowthChart();
        
        // Animate the stats counters
        animateNumbers();
        
        // Animate the city salary bars
        animateCitySalaryBars();
        
        // Animate role salary ranges
        animateRoleRanges();
        
        // Initialize interactive elements
        initializeInteractivity(experienceChart, growthChart);
    });
    
    function createExperienceSalaryChart() {
        const ctx = document.getElementById('experience-salary-chart').getContext('2d');
        
        return new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['0-2 Years', '2-4 Years', '4-6 Years', '6-8 Years', '8-10 Years', '10-15 Years', '15+ Years'],
                datasets: [{
                    label: 'Average Annual Salary (₹ Lakhs)',
                    data: [7.2, 11.5, 16.2, 21.8, 27.5, 36.0, 48.5],
                        backgroundColor: [
                        'rgba(99, 102, 241, 0.5)',
                        'rgba(99, 102, 241, 0.55)',
                        'rgba(99, 102, 241, 0.6)',
                        'rgba(99, 102, 241, 0.65)',
                            'rgba(99, 102, 241, 0.7)',
                        'rgba(99, 102, 241, 0.75)',
                        'rgba(99, 102, 241, 0.8)'
                    ],
                    borderColor: [
                        'rgba(99, 102, 241, 1)',
                        'rgba(99, 102, 241, 1)',
                        'rgba(99, 102, 241, 1)',
                        'rgba(99, 102, 241, 1)',
                        'rgba(99, 102, 241, 1)',
                        'rgba(99, 102, 241, 1)',
                        'rgba(99, 102, 241, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Annual Salary (₹ Lakhs)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Experience Level'
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Avg Salary: ₹${context.raw}L per annum`;
                            }
                        }
                    }
                }
            }
        });
    }
    
    function createSalaryGrowthChart() {
        const ctx = document.getElementById('salary-growth-chart').getContext('2d');
        
        return new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['2019', '2020', '2021', '2022', '2023', '2024 (Proj)'],
                datasets: [
                    {
                        label: 'AI/ML Specialists',
                        data: [14.2, 16.0, 18.5, 22.0, 26.5, 30.8],
                        borderColor: 'rgba(99, 102, 241, 1)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Cloud/DevOps Engineers',
                        data: [12.8, 14.5, 16.8, 19.2, 22.0, 25.5],
                        borderColor: 'rgba(16, 185, 129, 1)',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Full Stack Developers',
                        data: [11.5, 12.8, 14.0, 15.5, 17.2, 19.5],
                        borderColor: 'rgba(245, 158, 11, 1)',
                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Overall Tech Average',
                        data: [9.2, 9.8, 10.5, 11.8, 13.8, 15.2],
                        borderColor: 'rgba(99, 102, 241, 0.6)',
                        backgroundColor: 'rgba(99, 102, 241, 0.05)',
                        borderDash: [5, 5],
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        title: {
                            display: true,
                            text: 'Annual Salary (₹ Lakhs)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Year'
                        }
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ₹${context.raw}L`;
                            }
                        }
                    }
                }
            }
        });
    }
    
    function animateNumbers() {
        document.querySelectorAll('.animated-number').forEach(element => {
            const finalValue = parseFloat(element.getAttribute('data-value'));
            const duration = 1500;
            const startTime = Date.now();
            
            function updateNumber() {
                const currentTime = Date.now();
                const elapsed = currentTime - startTime;
                
                if (elapsed < duration) {
                    const value = (elapsed / duration) * finalValue;
                    element.textContent = value.toFixed(1);
                    requestAnimationFrame(updateNumber);
                } else {
                    element.textContent = finalValue;
                }
            }
            
            updateNumber();
        });
    }
    
    function animateCitySalaryBars() {
        const salaryBars = document.querySelectorAll('.salary-bar-fill');
        
        salaryBars.forEach((bar, index) => {
            setTimeout(() => {
                bar.style.width = bar.getAttribute('data-width');
            }, index * 150);
        });
    }
    
    function animateRoleRanges() {
        const rangeFills = document.querySelectorAll('.range-fill');
        const rangeMarkers = document.querySelectorAll('.range-marker');
        
        rangeFills.forEach((fill, index) => {
            setTimeout(() => {
                fill.style.left = fill.getAttribute('data-left');
                fill.style.width = fill.getAttribute('data-width');
                
                // Animate the corresponding marker
                if (rangeMarkers[index]) {
                    rangeMarkers[index].style.left = rangeMarkers[index].getAttribute('data-left');
                }
            }, index * 150);
        });
    }
    
    function initializeInteractivity(experienceChart, growthChart) {
        // Toggle chart type
        document.querySelectorAll('.toggle-chart-view').forEach(button => {
            button.addEventListener('click', function() {
                const chartId = this.getAttribute('data-chart');
                const chartType = this.getAttribute('data-type');
                
                // Update button states
                document.querySelectorAll(`[data-chart="${chartId}"]`).forEach(btn => {
                    btn.classList.remove('btn-outline-primary', 'btn-primary');
                    btn.classList.add(btn === this ? 'btn-primary' : 'btn-outline-primary');
                });
                
                // Change chart type
                if (chartId === 'experience-salary-chart') {
                    experienceChart.config.type = chartType;
                    experienceChart.update();
                }
            });
        });
        
        // Reset animation button
        document.getElementById('resetAnimation').addEventListener('click', function() {
            const salaryBars = document.querySelectorAll('.salary-bar-fill');
            
            salaryBars.forEach(bar => {
                bar.style.width = '0%';
            });
            
            setTimeout(() => {
                animateCitySalaryBars();
            }, 200);
        });
        
        // Sort by salary button
        document.getElementById('sortBySalary').addEventListener('click', function() {
            const container = document.getElementById('city-salary-container');
            const items = Array.from(container.querySelectorAll('.city-salary'));
            
            items.sort((a, b) => {
                const valueA = parseFloat(a.querySelector('.salary-bar-fill').getAttribute('data-value'));
                const valueB = parseFloat(b.querySelector('.salary-bar-fill').getAttribute('data-value'));
                return valueB - valueA;
            });
            
            // Clear the container
            container.innerHTML = '';
            
            // Re-add the sorted items
            items.forEach(item => {
                container.appendChild(item);
            });
            
            // Trigger animation
            const salaryBars = document.querySelectorAll('.salary-bar-fill');
            salaryBars.forEach(bar => {
                bar.style.width = '0%';
            });
            
            setTimeout(() => {
                animateCitySalaryBars();
            }, 200);
        });
        
        // Sort by city button
        document.getElementById('sortByCity').addEventListener('click', function() {
            const container = document.getElementById('city-salary-container');
            const items = Array.from(container.querySelectorAll('.city-salary'));
            
            items.sort((a, b) => {
                const cityA = a.querySelector('.city').textContent;
                const cityB = b.querySelector('.city').textContent;
                return cityA.localeCompare(cityB);
            });
            
            // Clear the container
            container.innerHTML = '';
            
            // Re-add the sorted items
            items.forEach(item => {
                container.appendChild(item);
            });
            
            // Trigger animation
            const salaryBars = document.querySelectorAll('.salary-bar-fill');
            salaryBars.forEach(bar => {
                bar.style.width = '0%';
            });
            
            setTimeout(() => {
                animateCitySalaryBars();
            }, 200);
        });
        
        // Filter salary trends
        document.querySelectorAll('[data-role]').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const role = this.getAttribute('data-role');
                
                if (role === 'all') {
                    growthChart.data.datasets.forEach(dataset => {
                        dataset.hidden = false;
                    });
                } else {
                    growthChart.data.datasets.forEach(dataset => {
                        dataset.hidden = dataset.label !== role;
                    });
                }
                
                growthChart.update();
            });
        });
        
        // Salary bar animation toggle
        document.getElementById('animateBars').addEventListener('change', function() {
            if (this.checked) {
                document.querySelectorAll('.salary-bar-fill').forEach(bar => {
                    bar.style.transition = 'width 0.8s ease-in-out';
                });
            } else {
                document.querySelectorAll('.salary-bar-fill').forEach(bar => {
                    bar.style.transition = 'none';
                });
            }
        });
    }
</script>
{% endblock %} 