<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Application Status Update</title>
    <style>
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9fafb;
            color: #1e293b;
            line-height: 1.6;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #ffffff;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .header {
            padding: 2rem 1.5rem;
            text-align: center;
            background: linear-gradient(135deg, #4f46e5 0%, #0ea5e9 100%);
            color: white;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .status-badge {
            display: inline-block;
            padding: 0.375rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            font-weight: 600;
            margin-top: 0.75rem;
            background-color: #f1f5f9;
            color: #1e293b;
        }
        .status-applied {
            background-color: #0ea5e9;
            color: white;
        }
        .status-review {
            background-color: #f59e0b;
            color: white;
        }
        .status-interview {
            background-color: #8b5cf6;
            color: white;
        }
        .status-shortlisted {
            background-color: #10b981;
            color: white;
        }
        .status-offered {
            background-color: #10b981;
            color: white;
        }
        .status-rejected {
            background-color: #ef4444;
            color: white;
        }
        .content {
            padding: 2rem 1.5rem;
        }
        .section {
            margin-bottom: 1.5rem;
        }
        .section-title {
            font-size: 1.125rem;
            margin-bottom: 1rem;
            color: #4f46e5;
            font-weight: 600;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 0.625rem;
            position: relative;
        }
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(90deg, #4f46e5 0%, #0ea5e9 100%);
            border-radius: 1px;
        }
        .job-info {
            background-color: #f8fafc;
            padding: 1rem;
            border-radius: 0.375rem;
            margin-bottom: 1.25rem;
            border-left: 4px solid #4f46e5;
        }
        .job-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.625rem;
            color: #4f46e5;
        }
        .company-logo {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }
        .company-logo img {
            max-height: 50px;
            max-width: 150px;
        }
        .job-meta {
            margin-bottom: 0.625rem;
            font-size: 0.875rem;
            color: #64748b;
        }
        .job-meta-item {
            margin-bottom: 0.375rem;
        }
        .status-info {
            background-color: #f8fafc;
            border-radius: 0.375rem;
            padding: 1.25rem;
            margin-bottom: 1.25rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .status-timeline {
            display: flex;
            justify-content: space-between;
            margin: 2rem 0;
            position: relative;
        }
        .status-timeline::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 3px;
            background-color: #e2e8f0;
            z-index: 1;
        }
        .timeline-step {
            position: relative;
            z-index: 2;
            text-align: center;
            width: 16%;
        }
        .timeline-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            border: 3px solid #fff;
            color: #fff;
            font-weight: 700;
            font-size: 0.875rem;
        }
        .timeline-label {
            font-size: 0.75rem;
            color: #64748b;
            white-space: nowrap;
        }
        .timeline-complete .timeline-dot {
            background-color: #0ea5e9;
        }
        .timeline-current .timeline-dot {
            background-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
        }
        .timeline-current .timeline-label {
            color: #10b981;
            font-weight: 600;
        }
        .next-steps {
            margin-top: 1.25rem;
            background-color: #fffbeb;
            border-radius: 0.375rem;
            padding: 1rem;
            border-left: 4px solid #f59e0b;
        }
        .next-steps-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.625rem;
        }
        .next-steps ul {
            margin: 0;
            padding: 0 0 0 1.25rem;
        }
        .next-steps li {
            margin-bottom: 0.5rem;
        }
        .feedback-section {
            margin-top: 1.25rem;
            padding: 1rem;
            background-color: #f8fafc;
            border-radius: 0.375rem;
            border-left: 4px solid #64748b;
        }
        .feedback-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.625rem;
        }
        .cta-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-top: 1.5rem;
        }
        .cta-button {
            display: inline-block;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            font-weight: 600;
            font-size: 0.875rem;
            text-align: center;
            transition: all 0.3s ease;
            margin-bottom: 0.625rem;
        }
        .primary-cta {
            background-color: #4f46e5;
            color: white;
        }
        .primary-cta:hover {
            background-color: #4338ca;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .secondary-cta {
            background-color: #f8fafc;
            color: #4f46e5;
            border: 1px solid #e2e8f0;
        }
        .secondary-cta:hover {
            background-color: #f1f5f9;
            color: #4338ca;
            border-color: #4f46e5;
        }
        .cta-button:hover {
            opacity: 0.9;
        }
        .cta-wide {
            flex: 0 0 100%;
        }
        .cta-half {
            flex: 0 0 48%;
        }
        .similar-jobs {
            margin-top: 1.875rem;
        }
        .job-card {
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        .job-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        .job-card-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.375rem;
            font-size: 1rem;
        }
        .job-card-company {
            color: #64748b;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }
        .job-card-details {
            display: flex;
            font-size: 0.8125rem;
            color: #64748b;
        }
        .job-card-detail {
            margin-right: 1rem;
        }
        .job-card-link {
            display: inline-block;
            margin-top: 0.625rem;
            color: #4f46e5;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        .job-card-link:hover {
            color: #4338ca;
            text-decoration: underline;
        }
        .footer {
            background-color: #f8fafc;
            padding: 1.25rem;
            text-align: center;
            font-size: 0.75rem;
            color: #64748b;
            border-top: 1px solid #e2e8f0;
        }
        .footer a {
            color: #4f46e5;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        .footer a:hover {
            color: #4338ca;
            text-decoration: underline;
        }
        @media only screen and (max-width: 600px) {
            .container {
                width: 100%;
                border-radius: 0;
            }
            .cta-buttons {
                flex-direction: column;
            }
            .cta-button {
                margin-bottom: 0.625rem;
                width: 100%;
            }
            .cta-half {
                flex: 0 0 100%;
            }
            .status-timeline {
                flex-wrap: wrap;
            }
            .timeline-step {
                width: 33%;
                margin-bottom: 1rem;
            }
            .timeline-step:nth-child(n+4) {
                margin-top: 1rem;
            }
            .timeline-step:nth-child(4) {
                margin-left: 17%;
            }
            .status-timeline::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Application Status Update</h1>
            <div class="status-badge status-{{ application.status|lower }}">
                {{ application.status|title }}
            </div>
        </div>
        <div class="content">
            <p>Hello {{ applicant.name }},</p>
            <p>We have an update regarding your application for the following position:</p>
            
            <div class="section">
                <div class="job-info">
                    {% if company.logo %}
                    <div class="company-logo">
                        <img src="{{ company.logo }}" alt="{{ company.name }}" />
                    </div>
                    {% endif %}
                    <div class="job-title">{{ job.title }}</div>
                    <div class="job-meta">
                        <div class="job-meta-item"><strong>Company:</strong> {{ company.name }}</div>
                        <div class="job-meta-item"><strong>Location:</strong> {{ job.location }}</div>
                        <div class="job-meta-item"><strong>Applied on:</strong> {{ application.application_date|date }}</div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Current Status</div>
                <div class="status-info">
                    <p>{{ status_message }}</p>
                    
                    <div class="status-timeline">
                        <div class="timeline-step {% if application.status_index >= 1 %}timeline-complete{% endif %}">
                            <div class="timeline-dot">1</div>
                            <div class="timeline-label">Applied</div>
                        </div>
                        <div class="timeline-step {% if application.status_index >= 2 %}timeline-complete{% endif %} {% if application.status_index == 2 %}timeline-current{% endif %}">
                            <div class="timeline-dot">2</div>
                            <div class="timeline-label">Review</div>
                        </div>
                        <div class="timeline-step {% if application.status_index >= 3 %}timeline-complete{% endif %} {% if application.status_index == 3 %}timeline-current{% endif %}">
                            <div class="timeline-dot">3</div>
                            <div class="timeline-label">Interview</div>
                        </div>
                        <div class="timeline-step {% if application.status_index >= 4 %}timeline-complete{% endif %} {% if application.status_index == 4 %}timeline-current{% endif %}">
                            <div class="timeline-dot">4</div>
                            <div class="timeline-label">Shortlisted</div>
                        </div>
                        <div class="timeline-step {% if application.status_index >= 5 %}timeline-complete{% endif %} {% if application.status_index == 5 %}timeline-current{% endif %}">
                            <div class="timeline-dot">5</div>
                            <div class="timeline-label">Decision</div>
                        </div>
                    </div>
                    
                    {% if application.status == 'rejected' %}
                    <div class="feedback-section">
                        <div class="feedback-title">Feedback from Recruiter</div>
                        <p>{{ feedback_message|default('Thank you for your interest in this position. While we were impressed with your qualifications, we have decided to move forward with other candidates who better match our current needs. We encourage you to apply for future positions that match your qualifications.', true) }}</p>
                    </div>
                    {% endif %}
                    
                    {% if next_steps %}
                    <div class="next-steps">
                        <div class="next-steps-title">Next Steps</div>
                        <ul>
                            {% for step in next_steps %}
                            <li>{{ step }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                
                <div class="cta-buttons">
                    <a href="{{ url_for('applications.status', application_id=application.id, _external=True) }}" class="cta-button primary-cta cta-wide">View Application Details</a>
                    
                    {% if application.status == 'interview' %}
                    <a href="{{ url_for('interviews.schedule', application_id=application.id, _external=True) }}" class="cta-button primary-cta cta-half">Schedule Interview</a>
                    <a href="{{ url_for('interviews.prepare', job_id=job.id, _external=True) }}" class="cta-button secondary-cta cta-half">Interview Preparation</a>
                    {% elif application.status == 'offered' %}
                    <a href="{{ url_for('offers.review', offer_id=offer.id, _external=True) }}" class="cta-button primary-cta cta-half">Review Offer</a>
                    <a href="{{ url_for('offers.negotiate', offer_id=offer.id, _external=True) }}" class="cta-button secondary-cta cta-half">Discuss Offer</a>
                    {% elif application.status == 'rejected' %}
                    <a href="{{ url_for('jobs.similar', job_id=job.id, _external=True) }}" class="cta-button secondary-cta cta-half">View Similar Jobs</a>
                    <a href="{{ url_for('profile.update', _external=True) }}" class="cta-button secondary-cta cta-half">Update Your Profile</a>
                    {% endif %}
                </div>
            </div>
            
            {% if similar_jobs %}
            <div class="section similar-jobs">
                <div class="section-title">You Might Also Be Interested In</div>
                {% for job in similar_jobs %}
                <div class="job-card">
                    <div class="job-card-title">{{ job.title }}</div>
                    <div class="job-card-company">{{ job.company_name }}</div>
                    <div class="job-card-details">
                        <div class="job-card-detail">
                            <i class="icon-location"></i> {{ job.location }}
                        </div>
                        <div class="job-card-detail">
                            <i class="icon-salary"></i> {{ job.salary_range }}
                        </div>
                        <div class="job-card-detail">
                            <i class="icon-type"></i> {{ job.job_type }}
                        </div>
                    </div>
                    <a href="{{ url_for('jobs.view', job_id=job.id, _external=True) }}" class="job-card-link">View Job Details →</a>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            <p>If you have any questions, please don't hesitate to contact us.</p>
            <p>Best regards,<br>The {{ company.name }} Recruitment Team</p>
        </div>
        <div class="footer">
            <p>This is an automated email from our recruitment system.</p>
            <p>
                <a href="{{ url_for('dashboard.index', _external=True) }}">Your Dashboard</a> | 
                <a href="{{ url_for('applications.index', _external=True) }}">Your Applications</a> | 
                <a href="{{ url_for('settings.notifications', _external=True) }}">Email Preferences</a>
            </p>
        </div>
    </div>
</body>
</html>